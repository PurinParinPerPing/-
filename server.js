require('dotenv').config(); // à¹‚à¸«à¸¥à¸”à¸•à¸±à¸§à¹à¸›à¸£à¸ˆà¸²à¸ .env
const express = require('express');
const line = require('@line/bot-sdk');
const app = express();

// à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸² config à¸ˆà¸²à¸ ENV
const config = {
  channelAccessToken: process.env.LINE_CHANNEL_ACCESS_TOKEN,
  channelSecret: process.env.LINE_CHANNEL_SECRET
};

// LINE client
const client = new line.Client(config);

// Middleware
app.post('/webhook', line.middleware(config), async (req, res) => {
  const events = req.body.events;
  const results = await Promise.all(events.map(handleEvent));
  res.json(results);
});

// à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™à¸•à¸­à¸šà¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡
function replyText(replyToken, text) {
  return client.replyMessage(replyToken, {
    type: 'text',
    text
  });
}

// à¸”à¸¶à¸‡à¸Šà¸·à¹ˆà¸­à¸œà¸¹à¹‰à¹ƒà¸Šà¹‰à¸ˆà¸²à¸ userId
async function getUserDisplayName(userId) {
  try {
    const profile = await client.getProfile(userId);
    return profile.displayName || '';
  } catch (error) {
    console.error('Error getting user profile:', error);
    return '';
  }
}

// à¹‚à¸„à¹‰à¸” handleEvent (à¸ˆà¸²à¸à¸—à¸µà¹ˆà¸„à¸¸à¸“à¹ƒà¸«à¹‰à¸¡à¸²)
async function handleEvent(event) {
  console.log('Received event:', JSON.stringify(event, null, 2));
  if (event.type !== 'message' || event.message.type !== 'text') {
    return Promise.resolve(null);
  }

  const text = event.message.text.toLowerCase();

  const greetings = ['à¸ªà¸§à¸±à¸ªà¸”à¸µ', 'à¸”à¸µà¸„à¸£à¸±à¸š', 'à¸”à¸µà¸„à¹ˆà¸°', 'hello', 'hi', 'hey', 'à¸—à¸±à¸', 'à¸¡à¸µà¹ƒà¸„à¸£à¸­à¸¢à¸¹à¹ˆà¹„à¸«à¸¡'];
  if (greetings.some(g => text.includes(g))) {
    const displayName = event.source?.userId
      ? await getUserDisplayName(event.source.userId)
      : 'à¸„à¹ˆà¸°';
    return replyText(event.replyToken, `à¸ªà¸§à¸±à¸ªà¸”à¸µà¸„à¸¸à¸“${displayName} ðŸ˜Š à¸¡à¸µà¸­à¸°à¹„à¸£à¹ƒà¸«à¹‰à¸Šà¹ˆà¸§à¸¢à¸ªà¸­à¸šà¸–à¸²à¸¡à¹„à¸”à¹‰à¸™à¸°à¸„à¸°`);
  }

  const priceCalcResult = calculatePrice(text); // *à¸«à¸²à¸à¹ƒà¸Šà¹‰à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™à¸™à¸µà¹‰à¸•à¹‰à¸­à¸‡à¸™à¸´à¸¢à¸²à¸¡à¹€à¸žà¸´à¹ˆà¸¡
  if (priceCalcResult) {
    return replyText(event.replyToken, priceCalcResult + '\nà¸«à¸²à¸à¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¸ˆà¸­à¸‡ à¸à¸£à¸¸à¸“à¸²à¹à¸ˆà¹‰à¸‡à¹€à¸žà¸·à¹ˆà¸­à¸”à¸³à¹€à¸™à¸´à¸™à¸à¸²à¸£à¸•à¹ˆà¸­à¹„à¸”à¹‰à¹€à¸¥à¸¢à¸„à¹ˆà¸°');
  }

  const extraQuestions = [
    {
      keywords: ['à¹€à¸ªà¸µà¸¢à¸•à¸£à¸‡à¸™à¸µà¹‰à¸•à¹‰à¸­à¸‡à¹€à¸ªà¸µà¸¢à¹€à¸žà¸´à¹ˆà¸¡à¹„à¸«à¸¡', 'à¸•à¹‰à¸­à¸‡à¹€à¸ªà¸µà¸¢à¹€à¸žà¸´à¹ˆà¸¡à¹„à¸«à¸¡', 'à¹€à¸ªà¸µà¸¢à¹€à¸žà¸´à¹ˆà¸¡à¹„à¸«à¸¡', 'à¸¡à¸µà¸„à¹ˆà¸²à¹ƒà¸Šà¹‰à¸ˆà¹ˆà¸²à¸¢à¹€à¸žà¸´à¹ˆà¸¡à¹„à¸«à¸¡', 'à¸ˆà¹ˆà¸²à¸¢à¹€à¸žà¸´à¹ˆà¸¡', 'à¸ˆà¹ˆà¸²à¸¢à¹€à¸žà¸´à¹ˆà¸¡à¹„à¸«à¸¡', 'à¹€à¸ªà¸µà¸¢à¹€à¸žà¸´à¹ˆà¸¡'],
      reply: 'à¹„à¸¡à¹ˆà¸¡à¸µà¸„à¹ˆà¸²à¹ƒà¸Šà¹‰à¸ˆà¹ˆà¸²à¸¢à¹€à¸žà¸´à¹ˆà¸¡à¹€à¸•à¸´à¸¡à¸„à¹ˆà¸°'
    },
    {
      keywords: ['à¹‚à¸›à¸£à¸™à¸µà¹‰à¸¡à¸µà¸–à¸¶à¸‡à¹€à¸¡à¸·à¹ˆà¸­à¹„à¸«à¸£à¹ˆ', 'à¹‚à¸›à¸£à¸«à¸¡à¸”à¹€à¸¡à¸·à¹ˆà¸­à¹„à¸«à¸£à¹ˆ', 'à¹‚à¸›à¸£à¸ªà¸´à¹‰à¸™à¸ªà¸¸à¸”à¹€à¸¡à¸·à¹ˆà¸­à¹„à¸«à¸£à¹ˆ', 'à¹‚à¸›à¸£à¸™à¸µà¹‰à¸ªà¸´à¹‰à¸™à¸ªà¸¸à¸”à¹€à¸¡à¸·à¹ˆà¸­à¹„à¸«à¸£à¹ˆ', 'à¹‚à¸›à¸£à¹‚à¸¡à¸Šà¸±à¹ˆà¸™à¸«à¸¡à¸”à¹€à¸¡à¸·à¹ˆà¸­à¹„à¸«à¸£à¹ˆ'],
      reply: 'à¹‚à¸›à¸£à¹‚à¸¡à¸Šà¸±à¹ˆà¸™à¸™à¸µà¹‰à¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¸¡à¸µà¸§à¸±à¸™à¸ªà¸´à¹‰à¸™à¸ªà¸¸à¸”à¸„à¹ˆà¸°'
    },
    {
      keywords: ['à¸ªà¸¡à¸±à¸„à¸£à¸‡à¸²à¸™à¹„à¸”à¹‰à¹„à¸«à¸¡', 'à¸£à¸±à¸šà¸ªà¸¡à¸±à¸„à¸£à¸‡à¸²à¸™à¹„à¸«à¸¡', 'à¸ªà¸¡à¸±à¸„à¸£à¸‡à¸²à¸™à¹„à¸”à¹‰à¸—à¸µà¹ˆà¹„à¸«à¸™', 'à¸­à¸¢à¸²à¸à¸ªà¸¡à¸±à¸„à¸£à¸‡à¸²à¸™', 'à¸¡à¸µà¸‡à¸²à¸™à¸—à¸³à¹„à¸«à¸¡'],
      reply: 'à¸ªà¸²à¸¡à¸²à¸£à¸–à¸ªà¸¡à¸±à¸„à¸£à¸‡à¸²à¸™à¹„à¸”à¹‰à¸—à¸µà¹ˆà¸ªà¸¢à¸²à¸¡à¸Šà¸±à¸¢à¸«à¸²à¸”à¸—à¸£à¸²à¸¢à¸‚à¸²à¸§à¸„à¹ˆà¸°'
    },
    {
      keywords: ['à¸ˆà¸³à¸à¸±à¸”à¸ˆà¸³à¸™à¸§à¸™à¹„à¸«à¸¡', 'à¸¡à¸µà¸ˆà¸³à¸à¸±à¸”à¸ˆà¸³à¸™à¸§à¸™à¹„à¸«à¸¡', 'à¸ˆà¸³à¸™à¸§à¸™à¸ˆà¸³à¸à¸±à¸”à¹„à¸«à¸¡', 'à¸ˆà¸³à¸à¸±à¸”à¸œà¸¹à¹‰à¹€à¸‚à¹‰à¸²à¸£à¹ˆà¸§à¸¡à¹„à¸«à¸¡', 'à¸ˆà¸³à¸™à¸§à¸™à¸„à¸™à¸ˆà¸³à¸à¸±à¸”à¹„à¸«à¸¡'],
      reply: 'à¸¥à¸¹à¸à¸„à¹‰à¸²à¸ªà¸²à¸¡à¸²à¸£à¸–à¹€à¸‚à¹‰à¸²à¸¡à¸²à¹„à¸”à¹‰à¹‚à¸”à¸¢à¹„à¸¡à¹ˆà¸ˆà¸³à¸à¸±à¸”à¸ˆà¸³à¸™à¸§à¸™à¸„à¹ˆà¸°'
    },
    {
      keywords: ['à¸ˆà¸¸à¸”à¸›à¸à¸¡à¸žà¸¢à¸²à¸šà¸²à¸¥', 'à¸¡à¸µà¸ˆà¸¸à¸”à¸›à¸à¸¡à¸žà¸¢à¸²à¸šà¸²à¸¥à¹„à¸«à¸¡', 'à¸›à¸à¸¡à¸žà¸¢à¸²à¸šà¸²à¸¥', 'à¸ªà¸–à¸²à¸™à¸µà¸›à¸à¸¡à¸žà¸¢à¸²à¸šà¸²à¸¥', 'à¸—à¸µà¹ˆà¸›à¸à¸¡à¸žà¸¢à¸²à¸šà¸²à¸¥'],
      reply: 'à¸¡à¸µà¸ˆà¸¸à¸”à¸›à¸à¸¡à¸žà¸¢à¸²à¸šà¸²à¸¥à¹ƒà¸«à¹‰à¸šà¸£à¸´à¸à¸²à¸£à¸—à¸µà¹ˆà¸šà¸£à¸´à¹€à¸§à¸“à¸—à¸²à¸‡à¹€à¸‚à¹‰à¸² à¸¥à¸¹à¸à¸„à¹‰à¸²à¸ªà¸²à¸¡à¸²à¸£à¸–à¸•à¸´à¸”à¸•à¹ˆà¸­à¹€à¸ˆà¹‰à¸²à¸«à¸™à¹‰à¸²à¸—à¸µà¹ˆà¹„à¸”à¹‰à¹€à¸¥à¸¢à¸„à¹ˆà¸°'
    }
  ];
  for (const q of extraQuestions) {
    if (q.keywords.some(k => text.includes(k))) {
      return replyText(event.replyToken, q.reply);
    }
  }

  const bookingKeywords = ['à¸‹à¸·à¹‰à¸­', 'à¸ˆà¸­à¸‡', 'à¸‹à¸·à¹‰à¸­à¸•à¸±à¹‹à¸§', 'à¸ˆà¸­à¸‡à¸•à¸±à¹‹à¸§', 'à¸ˆà¸­à¸‡à¸šà¸±à¸•à¸£', 'à¸‹à¸·à¹‰à¸­à¸•à¸±à¹‹à¸§à¹€à¸‚à¹‰à¸²'];
  if (bookingKeywords.some(k => text.includes(k))) {
    return replyText(event.replyToken, 'à¸„à¸¸à¸“à¸ªà¸²à¸¡à¸²à¸£à¸–à¸‹à¸·à¹‰à¸­à¸šà¸±à¸•à¸£à¸œà¹ˆà¸²à¸™à¸—à¸²à¸‡ LINE à¸™à¸µà¹‰à¹„à¸”à¹‰à¹€à¸¥à¸¢à¸„à¹ˆà¸° à¸à¸£à¸¸à¸“à¸²à¹à¸ˆà¹‰à¸‡à¸ˆà¸³à¸™à¸§à¸™à¸œà¸¹à¹‰à¹ƒà¸«à¸à¹ˆà¹à¸¥à¸°à¹€à¸”à¹‡à¸à¸—à¸µà¹ˆà¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¸ˆà¸­à¸‡à¸„à¹ˆà¸°');
  }

  if (text.includes('à¸Šà¸³à¸£à¸°') || text.includes('à¸ˆà¹ˆà¸²à¸¢') || text.includes('à¹‚à¸­à¸™')) {
    return client.replyMessage(event.replyToken, {
      type: 'image',
      originalContentUrl: 'https://cdn.glitch.global/.../à¸ªà¸¥à¸´à¸›à¹€à¸ˆà¹‰à¸².jfif',
      previewImageUrl: 'https://cdn.glitch.global/.../à¸ªà¸¥à¸´à¸›à¹€à¸ˆà¹‰à¸².jfif'
    });
  }

  const checks = [
    {
      keywords: ['à¹€à¸›à¸´à¸”', 'à¹€à¸§à¸¥à¸²à¸—à¸³à¸à¸²à¸£', 'à¸à¸µà¹ˆà¹‚à¸¡à¸‡'],
      reply: 'à¹€à¸›à¸´à¸”à¹ƒà¸«à¹‰à¸šà¸£à¸´à¸à¸²à¸£à¸—à¸¸à¸à¸§à¸±à¸™ à¸•à¸±à¹‰à¸‡à¹à¸•à¹ˆà¹€à¸§à¸¥à¸² 08.00 - 00.00 à¸™. à¸„à¹ˆà¸°'
    },
    {
      keywords: ['à¸ˆà¸­à¸”à¸£à¸–', 'à¸—à¸µà¹ˆà¸ˆà¸­à¸”à¸£à¸–', 'à¸¥à¸²à¸™à¸ˆà¸­à¸”à¸£à¸–'],
      reply: 'à¸—à¸²à¸‡à¹€à¸£à¸²à¸¡à¸µà¸—à¸µà¹ˆà¸ˆà¸­à¸”à¸£à¸–à¸Ÿà¸£à¸µà¸ªà¸³à¸«à¸£à¸±à¸šà¸¥à¸¹à¸à¸„à¹‰à¸²à¸—à¸¸à¸à¸—à¹ˆà¸²à¸™à¸„à¹ˆà¸°'
    },
    {
      keywords: ['à¸„à¹ˆà¸²à¹€à¸‚à¹‰à¸²', 'à¸£à¸²à¸„à¸²à¸šà¸±à¸•à¸£', 'à¸„à¹ˆà¸²à¹ƒà¸Šà¹‰à¸ˆà¹ˆà¸²à¸¢', 'à¸„à¹ˆà¸²à¸•à¸±à¹‹à¸§', 'à¸„à¹ˆà¸²à¸šà¸±à¸•à¸£', 'à¸šà¸±à¸•à¸£à¸£à¸²à¸„à¸²'],
      reply: 'à¸„à¹ˆà¸²à¹€à¸‚à¹‰à¸²à¸ªà¸¢à¸²à¸¡à¸Šà¸±à¸¢à¸«à¸²à¸”à¸—à¸£à¸²à¸¢à¸‚à¸²à¸§ à¸œà¸¹à¹‰à¹ƒà¸«à¸à¹ˆ 40 à¸šà¸²à¸— à¹€à¸”à¹‡à¸à¸•à¹ˆà¸³à¸à¸§à¹ˆà¸² 10 à¸›à¸µ à¹à¸¥à¸°à¸œà¸¹à¹‰à¸ªà¸¹à¸‡à¸­à¸²à¸¢à¸¸ à¹€à¸‚à¹‰à¸²à¸Ÿà¸£à¸µ\nà¹‚à¸‹à¸™à¸—à¸°à¹€à¸¥à¸™à¸„à¸£à¸›à¸à¸¡ à¸œà¸¹à¹‰à¹ƒà¸«à¸à¹ˆ 120 à¸šà¸²à¸— à¹€à¸”à¹‡à¸ 60 à¸šà¸²à¸—à¸„à¹ˆà¸°'
    },
    {
      keywords: ['à¸—à¸µà¹ˆà¹„à¸«à¸™', 'à¸­à¸¢à¸¹à¹ˆà¸—à¸µà¹ˆà¹„à¸«à¸™', 'à¸•à¸±à¹‰à¸‡à¸­à¸¢à¸¹à¹ˆ', 'à¹à¸œà¸™à¸—à¸µà¹ˆ'],
      reply: 'à¸ªà¸¢à¸²à¸¡à¸Šà¸±à¸¢à¸«à¸²à¸”à¸—à¸£à¸²à¸¢à¸‚à¸²à¸§à¸­à¸¢à¸¹à¹ˆà¸ˆà¸±à¸‡à¸«à¸§à¸±à¸”à¸™à¸„à¸£à¸›à¸à¸¡ à¸”à¸¹à¹à¸œà¸™à¸—à¸µà¹ˆ: https://g.co/kgs/k1Zv8V2'
    },
    {
      keywords: ['à¹€à¸¥à¹ˆà¸™à¸™à¹‰à¸³', 'à¸™à¹‰à¸³', 'à¸§à¹ˆà¸²à¸¢à¸™à¹‰à¸³'],
      reply: 'à¸ªà¸²à¸¡à¸²à¸£à¸–à¹€à¸¥à¹ˆà¸™à¸™à¹‰à¸³à¹„à¸”à¹‰à¸–à¸¶à¸‡ 18.00 à¸™. à¸«à¸£à¸·à¸­à¸šà¸£à¸´à¹€à¸§à¸“à¸«à¸¥à¸±à¸‡à¸£à¹‰à¸²à¸™à¸­à¸²à¸«à¸²à¸£à¸ªà¸²à¸¡à¸Šà¸±à¸¢à¹„à¸”à¹‰à¸–à¸¶à¸‡ 21.00 à¸™.'
    },
    {
      keywords: ['à¸­à¸²à¸«à¸²à¸£', 'à¸™à¸³à¸­à¸²à¸«à¸²à¸£', 'à¸‚à¸­à¸‡à¸à¸´à¸™', 'à¹€à¸„à¸£à¸·à¹ˆà¸­à¸‡à¸”à¸·à¹ˆà¸¡', 'à¸à¸´à¸™à¸­à¸°à¹„à¸£', 'à¸‚à¸²à¸¢à¸­à¸²à¸«à¸²à¸£'],
      reply: 'à¸ªà¸²à¸¡à¸²à¸£à¸–à¸™à¸³à¸­à¸²à¸«à¸²à¸£à¹€à¸‚à¹‰à¸²à¸¡à¸²à¹„à¸”à¹‰ à¸¢à¸à¹€à¸§à¹‰à¸™à¹€à¸„à¸£à¸·à¹ˆà¸­à¸‡à¸”à¸·à¹ˆà¸¡à¸‹à¸¶à¹ˆà¸‡à¹„à¸¡à¹ˆà¸­à¸™à¸¸à¸à¸²à¸•à¹ƒà¸«à¹‰à¸™à¸³à¹€à¸‚à¹‰à¸²à¸¡à¸²à¸„à¹ˆà¸° à¹à¸¥à¸°à¸ à¸²à¸¢à¹ƒà¸™à¸¡à¸µà¸£à¹‰à¸²à¸™à¸­à¸²à¸«à¸²à¸£à¹à¸¥à¸°à¹€à¸„à¸£à¸·à¹ˆà¸­à¸‡à¸”à¸·à¹ˆà¸¡à¸ˆà¸³à¸«à¸™à¹ˆà¸²à¸¢à¸”à¹‰à¸§à¸¢à¸„à¹ˆà¸°'
    },
    {
      keywords: ['à¸£à¹‰à¸²à¸™à¸„à¹‰à¸²', 'à¸£à¹‰à¸²à¸™à¸‚à¸²à¸¢à¸‚à¸­à¸‡', 'à¸£à¹‰à¸²à¸™à¸‚à¸²à¸¢', 'à¸¡à¸µà¸£à¹‰à¸²à¸™à¹„à¸«à¸¡'],
      reply: 'à¸¡à¸µà¸£à¹‰à¸²à¸™à¸„à¹‰à¸²à¹ƒà¸«à¹‰à¸šà¸£à¸´à¸à¸²à¸£à¸£à¸­à¸šà¸šà¸£à¸´à¹€à¸§à¸“à¸«à¸²à¸”à¹€à¸¥à¸¢à¸„à¹ˆà¸° à¸—à¸±à¹‰à¸‡à¸‚à¸­à¸‡à¸à¸´à¸™ à¸‚à¸­à¸‡à¹€à¸¥à¹ˆà¸™ à¹à¸¥à¸°à¸‚à¸­à¸‡à¹ƒà¸Šà¹‰à¸„à¹ˆà¸°'
    },
    {
      keywords: ['à¸„à¸­à¸™à¹€à¸ªà¸´à¸£à¹Œà¸•', 'à¸”à¸™à¸•à¸£à¸µ', 'à¹‚à¸Šà¸§à¹Œ', 'à¹à¸ªà¸”à¸‡'],
      reply: 'à¸ªà¸²à¸¡à¸²à¸£à¸–à¸•à¸´à¸”à¸•à¸²à¸¡à¸à¸´à¸ˆà¸à¸£à¸£à¸¡à¹à¸¥à¸°à¸„à¸­à¸™à¹€à¸ªà¸´à¸£à¹Œà¸•à¹„à¸”à¹‰à¸—à¸µà¹ˆ Facebook à¹€à¸žà¸ˆ "à¸ªà¸¢à¸²à¸¡à¸Šà¸±à¸¢à¸«à¸²à¸”à¸—à¸£à¸²à¸¢à¸‚à¸²à¸§" à¸„à¹ˆà¸°'
    },
    {
      keywords: ['à¸ªà¸±à¸•à¸§à¹Œ', 'à¸«à¸¡à¸²', 'à¹à¸¡à¸§', 'à¸ªà¸±à¸•à¸§à¹Œà¹€à¸¥à¸µà¹‰à¸¢à¸‡'],
      reply: 'à¸ªà¸²à¸¡à¸²à¸£à¸–à¸™à¸³à¸ªà¸±à¸•à¸§à¹Œà¹€à¸¥à¸µà¹‰à¸¢à¸‡à¹€à¸‚à¹‰à¸²à¸¡à¸²à¹„à¸”à¹‰ à¹‚à¸”à¸¢à¸¡à¸µà¸„à¹ˆà¸²à¸šà¸£à¸´à¸à¸²à¸£à¹€à¸—à¹ˆà¸²à¸à¸±à¸šà¸œà¸¹à¹‰à¹ƒà¸«à¸à¹ˆ à¹à¸¥à¸°à¸à¸£à¸¸à¸“à¸²à¸­à¸¢à¹ˆà¸²à¹ƒà¸«à¹‰à¸ªà¸±à¸•à¸§à¹Œà¹€à¸¥à¸µà¹‰à¸¢à¸‡à¸¥à¸‡à¹€à¸¥à¹ˆà¸™à¸™à¹‰à¸³à¸™à¸°à¸„à¸°'
    },
    {
      keywords: ['à¸„à¸·à¸­à¸­à¸°à¹„à¸£', 'à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ªà¸–à¸²à¸™à¸—à¸µà¹ˆ', 'à¸£à¸²à¸¢à¸¥à¸°à¹€à¸­à¸µà¸¢à¸”', 'à¸ªà¸–à¸²à¸™à¸—à¸µà¹ˆà¸—à¹ˆà¸­à¸‡à¹€à¸—à¸µà¹ˆà¸¢à¸§'],
      reply: 'à¸ªà¸¢à¸²à¸¡à¸Šà¸±à¸¢à¸«à¸²à¸”à¸—à¸£à¸²à¸¢à¸‚à¸²à¸§à¹€à¸›à¹‡à¸™à¸ªà¸–à¸²à¸™à¸—à¸µà¹ˆà¸žà¸±à¸à¸œà¹ˆà¸­à¸™à¸«à¸¢à¹ˆà¸­à¸™à¹ƒà¸ˆ à¸¡à¸µà¹‚à¸‹à¸™à¹€à¸¥à¹ˆà¸™à¸™à¹‰à¸³ à¸£à¹‰à¸²à¸™à¸­à¸²à¸«à¸²à¸£ à¹à¸¥à¸°à¸à¸´à¸ˆà¸à¸£à¸£à¸¡à¸„à¸£à¸­à¸šà¸„à¸£à¸±à¸§à¹ƒà¸™à¸ˆà¸±à¸‡à¸«à¸§à¸±à¸”à¸™à¸„à¸£à¸›à¸à¸¡à¸„à¹ˆà¸°'
    },
    {
      keywords: ['à¸«à¹‰à¸­à¸‡à¸žà¸±à¸', 'à¸—à¸µà¹ˆà¸žà¸±à¸', 'à¸žà¸±à¸', 'à¸™à¸­à¸™'],
      reply: 'à¸‚à¸“à¸°à¸™à¸µà¹‰à¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¸¡à¸µà¸šà¸£à¸´à¸à¸²à¸£à¸«à¹‰à¸­à¸‡à¸žà¸±à¸à¸„à¹ˆà¸° à¸¥à¸¹à¸à¸„à¹‰à¸²à¸ªà¸²à¸¡à¸²à¸£à¸–à¸žà¸±à¸à¸œà¹ˆà¸­à¸™à¹„à¸”à¹‰à¹ƒà¸™à¸Šà¹ˆà¸§à¸‡à¸à¸¥à¸²à¸‡à¸§à¸±à¸™à¹€à¸—à¹ˆà¸²à¸™à¸±à¹‰à¸™'
    }
  ];
  for (const item of checks) {
    if (item.keywords.some(k => text.includes(k))) {
      return replyText(event.replyToken, item.reply);
    }
  }

  return replyText(event.replyToken, 'à¸‚à¸­à¸­à¸ à¸±à¸¢à¸„à¹ˆà¸° à¹„à¸¡à¹ˆà¸ªà¸²à¸¡à¸²à¸£à¸–à¸•à¸­à¸šà¸„à¸³à¸–à¸²à¸¡à¸™à¸µà¹‰à¹„à¸”à¹‰à¹ƒà¸™à¸‚à¸“à¸°à¸™à¸µà¹‰ à¸«à¸²à¸à¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¸ªà¸­à¸šà¸–à¸²à¸¡à¹€à¸žà¸´à¹ˆà¸¡à¹€à¸•à¸´à¸¡ à¸à¸£à¸¸à¸“à¸²à¸£à¸°à¸šà¸¸à¸„à¸³à¸–à¸²à¸¡à¹ƒà¸«à¹‰à¸Šà¸±à¸”à¹€à¸ˆà¸™à¸‚à¸¶à¹‰à¸™à¸™à¸°à¸„à¸°');
}

// à¹€à¸›à¸´à¸”à¸žà¸­à¸£à¹Œà¸•à¸ªà¸³à¸«à¸£à¸±à¸š Render
const PORT = process.env.PORT || 3000;
app.listen(PORT, () => {
  console.log(`Server running on port ${PORT}`);
});
